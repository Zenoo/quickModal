class QuickModal{constructor(parameters,body){for(this._parameters={darkenBackground:!0,isForm:!1,closeText:"OK",classes:[],attributes:{},header:"<div>QuickModal</div>",body:[{type:"text",text:'This is a basic QuickModal. See the <a href="https://zenoo.github.io/quickModal/">documentation</a> for more.',tag:"p",classes:[]}],footer:[],afterOpen:()=>{},beforeClose:()=>{},onSubmit:()=>{}},this._parameters="string"==typeof parameters?{...this._parameters,header:"<div>"+parameters+"</div>",body:[{type:"text",text:body,tag:"p",classes:[]}],footer:[]}:{...this._parameters,...parameters},this.id=0;document.getElementById("quick-modal-"+this.id);)this.id++;this._elements={hider:null,body:null,footerLinks:null},this._build(),this._listen(),this.open()}_build(){this._buildFrame(),this._parameters.darkenBackground&&(this._elements.hider=document.createElement("div"),this._elements.hider.id="quick-modal-hider-"+this.id,this._elements.hider.classList.add("quick-modal-hider"),document.body.appendChild(this._elements.hider)),this._buildBody(),this._buildFooter(),document.body.append(this.modal)}_buildFrame(){this.modal=document.createElement("section"),this.modal.id="quick-modal-"+this.id,this.modal.classList.add("quick-modal",...this._parameters.classes),Object.entries(this._parameters.attributes).forEach(([attribute,value])=>{this.modal.setAttribute(attribute,value)}),this.modal.innerHTML=`\n\t\t\t${this._parameters.isForm?`\n\t\t\t\t<form \n\t\t\t\t\t${Reflect.ownKeys(this._parameters.form).includes("id")?'id="'+this._parameters.form.id+'"':""}\n\t\t\t\t\taction="${Reflect.ownKeys(this._parameters.form).includes("action")?this._parameters.form.action:"#"}"\n\t\t\t\t\tmethod="${Reflect.ownKeys(this._parameters.form).includes("method")?this._parameters.form.method:"POST"}"\n\t\t\t\t>\n\t\t\t`:""}\n\t\t\t<header>\n\t\t\t\t${this._parameters.header}\n\t\t\t\t<aside>x</aside>\n\t\t\t</header>\n\t\t\t<section class="quick-modal-main">\n\n\t\t\t</section>\n\t\t\t<footer>\n\t\t\t\t<ul>\n\t\t\t\t\t${this._parameters.isForm?`\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\ttype="submit" \n\t\t\t\t\t\t\t\tclass="quick-modal-generated-btn quick-modal-submit" \n\t\t\t\t\t\t\t\tvalue="${Reflect.ownKeys(this._parameters.form).includes("submit")?this._parameters.form.submit:"OK"}"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t`:""}\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a class="quick-modal-generated-btn quick-modal-close" href="">\n\t\t\t\t\t\t\t${this._parameters.closeText}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</footer>\n\t\t\t${this._parameters.isForm?"</form>":""}\n\t\t`,this._elements.body=this.modal.querySelector(".quick-modal-main"),this._elements.footerLinks=this.modal.querySelector("footer>ul")}_buildBody(){this._parameters.body.forEach(line=>{const lineAttributes=Reflect.ownKeys(line);if("text"==line.type){const element=document.createElement(line.tag);element.innerHTML=line.text,lineAttributes.includes("id")&&(element.id=line.id),lineAttributes.includes("classes")&&element.classList.add(...line.classes),lineAttributes.includes("attributes")&&Object.entries(line.attributes).forEach(([attribute,value])=>{element.setAttribute(attribute,value)}),this._elements.body.appendChild(element)}else if("form"==line.type)switch(line.tag){case"select":this._elements.body.append(...this._toNodes(`\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t${lineAttributes.includes("label")?`\n\t\t\t\t\t\t\t\t\t<label for="${lineAttributes.includes("id")?line.id:line.name}">${line.label}</label>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t<${line.tag} \n\t\t\t\t\t\t\t\t\tname="${line.tag}" \n\t\t\t\t\t\t\t\t\tid="${lineAttributes.includes("id")?line.id:line.name}"\n\t\t\t\t\t\t\t\t\tclass="${lineAttributes.includes("classes")?line.classes.join(" "):""}"\n\t\t\t\t\t\t\t\t\t${lineAttributes.includes("attributes")?Object.entries(line.attributes).reduce((acc,[attribute,value])=>acc+=attribute+'="'+value+'" ',""):""}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t${line.options.reduce((acc,option)=>`\n\t\t\t\t\t\t\t\t\t\t<option \n\t\t\t\t\t\t\t\t\t\t\t${Reflect.ownKeys(option).includes("attributes")?Object.entries(option.attributes).reduce((accu,[attribute,value])=>accu+=attribute+'="'+value+'" ',""):""}\n\t\t\t\t\t\t\t\t\t\t\tvalue="${option.value}"\n\t\t\t\t\t\t\t\t\t\t\t${option.selected?"selected":""}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t${option.text}\n\t\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t\t`,"")}\n\t\t\t\t\t\t\t\t</${line.tag}>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t`));break;default:this._elements.body.append(...this._toNodes(`\n\t\t\t\t\t\t\t${lineAttributes.includes("inputType")&&"hidden"==line.inputType?"":"<p>"}\n\t\t\t\t\t\t\t\t${lineAttributes.includes("label")?`\n\t\t\t\t\t\t\t\t\t<label for="${lineAttributes.includes("id")?line.id:line.name}">${line.label}</label>\n\t\t\t\t\t\t\t\t`:""}\n\t\t\t\t\t\t\t\t<${line.tag} \n\t\t\t\t\t\t\t\t\t${"textarea"==line.tag?"":lineAttributes.includes("inputType")?'type="'+line.inputType+'"':""}\n\t\t\t\t\t\t\t\t\tname="${line.tag}" \n\t\t\t\t\t\t\t\t\tid="${lineAttributes.includes("id")?line.id:line.name}"\n\t\t\t\t\t\t\t\t\tclass="${lineAttributes.includes("classes")?line.classes.join(" "):""}"\n\t\t\t\t\t\t\t\t\t${lineAttributes.includes("attributes")?Object.entries(line.attributes).reduce((acc,[attribute,value])=>acc+=attribute+'="'+value+'" ',""):""}\n\t\t\t\t\t\t\t\t\tplaceholder="${lineAttributes.includes("placeholder")?line.placeholder:""}"\n\t\t\t\t\t\t\t\t\tvalue="${lineAttributes.includes("value")?line.value:""}"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</${line.tag}>\n\t\t\t\t\t\t\t${lineAttributes.includes("inputType")&&"hidden"==line.inputType?"":"</p>"}\n\t\t\t\t\t\t`))}else console.warn(line),console.warn("QuickModal: The above element has an invalid `type` attribute. It has been ignored.")})}_buildFooter(){this._parameters.footer.forEach(link=>{const linkAttributes=Reflect.ownKeys(link);this._elements.footerLinks.prepend(...this._toNodes(`\n\t\t\t\t<li\n\t\t\t\t\tid="${linkAttributes.includes("id")?link.id:""}"\n\t\t\t\t\tclass="${linkAttributes.includes("classes")?link.classes.join(" "):""}"\n\t\t\t\t\t${linkAttributes.includes("attributes")?Object.entries(link.attributes).reduce((acc,[attribute,value])=>acc+=attribute+'="'+value+'" ',""):""}\n\t\t\t\t>\n\t\t\t\t\t<a class="quick-modal-generated-btn" href="${link.href}">\n\t\t\t\t\t\t${link.text}\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t`))})}_listen(){const closingHandler=e=>{e.preventDefault(),this.destroy()};if(this._elements.hider.addEventListener("click",closingHandler),this.modal.querySelectorAll(".quick-modal-close").forEach(button=>{button.addEventListener("click",closingHandler)}),this._parameters.isForm){const form=this.modal.querySelector("form");form.addEventListener("submit",e=>{Reflect.apply(this._parameters.onSubmit,this,[e,form])})}}_toNodes(html){const template=document.createElement("template");return template.innerHTML=html,template.content.childNodes}open(){return setTimeout(()=>{this.modal.classList.add("active"),this._parameters.darkenBackground&&this._elements.hider.classList.add("active"),Reflect.apply(this._parameters.afterOpen,this,[this.modal])},20),new Promise(resolve=>{setTimeout(()=>{resolve()},500)})}close(){return Reflect.apply(this._parameters.beforeClose,this,[this.modal]),this.modal.classList.remove("active"),this._parameters.darkenBackground&&this._elements.hider.classList.remove("active"),new Promise(resolve=>{setTimeout(()=>{resolve()},500)})}destroy(){this.close().then(()=>{this.modal.remove(),this._parameters.darkenBackground&&this._elements.hider.remove()})}static destroy(id){const modal=document.getElementById("quick-modal-"+id);modal&&(modal.querySelector(".quick-modal-close").dispatchEvent(new Event("click")),setTimeout(()=>{const hider=document.getElementById("quick-modal-hider-"+id);modal.remove(),hider&&hider.remove()},500))}}!function($){"use strict";$.fn.extend({quickModal(parameters){console.warn("QuickModal: Using `$(...).quickModal(...)` is deprecated. Use `const modal = new QuickModal(...)` instead.");const modal=new QuickModal(parameters);return this.open=(()=>{modal.open()}),this.close=(()=>{modal.close()}),this.destroy=(()=>{modal.destroy()}),this}})}(jQuery);